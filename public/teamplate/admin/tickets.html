<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý vé - Admin Panel</title>
    <link rel="stylesheet" href="/public/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h2>Admin Panel</h2>
            </div>
            <div class="sidebar-divider"></div>
            <ul class="menu">
                <li>
                    <a href="users.html">
                        <i class="fas fa-users"></i>
                        <span>Quản lý người dùng</span>
                    </a>
                </li>
                <li>
                    <a href="events.html">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Quản lý sự kiện</span>
                    </a>
                </li>
                <li class="active">
                    <a href="tickets.html">
                        <i class="fas fa-ticket-alt"></i>
                        <span>Quản lý vé</span>
                    </a>
                </li>
                <li>
                    <a href="payments.html">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Quản lý giao dịch</span>
                    </a>
                </li>
                <li>
                    <a href="reports.html">
                        <i class="fas fa-chart-bar"></i>
                        <span>Báo cáo thống kê</span>
                    </a>
                </li>
            </ul>
            <div class="sidebar-divider"></div>
            <div class="sidebar-footer">
                <p>© 2025 Admin Panel</p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <h1>Quản lý vé</h1>
                </div>
                <div class="header-right">
                    <div class="search-bar">
                        <input 
                            type="text" 
                            id="searchInput"
                            placeholder="Tìm kiếm vé..." 
                        >
                        <button class="search-btn">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div class="admin-profile">
                        <img src="/admin-avatar.png" alt="Admin">
                        <span>Admin</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Filter Section -->
                <div class="filter-section">
                    <div class="filter-container">
                        <div class="filter-group">
                            <label>
                                <i class="fas fa-calendar-alt"></i>
                                Sự kiện
                            </label>
                            <select name="event" class="filter-select">
                                <option value="">Tất cả sự kiện</option>
                                <option value="hoanhac">Hòa nhạc mùa xuân 2025</option>
                                <option value="hoithao">Hội thảo công nghệ 2025</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label>
                                <i class="fas fa-ticket-alt"></i>
                                Loại vé
                            </label>
                            <select name="ticketType" class="filter-select">
                                <option value="">Tất cả loại vé</option>
                                <option value="vip">VIP</option>
                                <option value="thuong">Thường</option>
                                <option value="kinhte">Kinh tế</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label>
                                <i class="fas fa-flag"></i>
                                Trạng thái
                            </label>
                            <select name="status" class="filter-select">
                                <option value="">Tất cả trạng thái</option>
                                <option value="used">Đã sử dụng</option>
                                <option value="unused">Chưa sử dụng</option>
                                <option value="cancelled">Đã hủy</option>
                            </select>
                        </div>

                        <div class="filter-buttons">
                            <button class="filter-button" onclick="applyFilters()">
                                <i class="fas fa-filter"></i>
                                Lọc
                            </button>
                            <button class="reset-button" onclick="resetFilters()">
                                <i class="fas fa-redo"></i>
                                Đặt lại
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Table Section -->
                <div class="table-container">
                    <div class="section-header">
                        <h2>Danh sách vé</h2>
                    </div>

                    <table class="ticket-table">
                        <thead>
                            <tr>
                                <th>Mã vé</th>
                                <th>Sự kiện</th>
                                <th>Loại vé</th>
                                <th>Khách hàng</th>
                                <th>Ngày mua</th>
                                <th>Giá vé</th>
                                <th>Trạng thái</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="ticketTableBody">
                            <!-- Ticket rows will be populated by JavaScript -->
                        </tbody>
                    </table>

                    <div class="pagination">
                        <a href="#first" onclick="goToPage('first')" title="Trang đầu">&laquo;</a>
                        <a href="#prev" onclick="goToPage('prev')" title="Trang trước">&lsaquo;</a>
                        <a href="#1" class="active">1</a>
                        <a href="#2">2</a>
                        <a href="#3">3</a>
                        <span>...</span>
                        <a href="#10">10</a>
                        <a href="#next" onclick="goToPage('next')" title="Trang sau">&rsaquo;</a>
                        <a href="#last" onclick="goToPage('last')" title="Trang cuối">&raquo;</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mock data cho danh sách vé
        const tickets = [
            {
                id: 'T001',
                eventName: 'Hòa nhạc mùa xuân 2025',
                ticketType: 'VIP',
                customerName: 'Nguyễn Văn A',
                purchaseDate: '2025-03-01',
                price: '1500000',
                status: 'Đã sử dụng'
            },
            {
                id: 'T002',
                eventName: 'Hòa nhạc mùa xuân 2025',
                ticketType: 'Thường',
                customerName: 'Trần Thị B',
                purchaseDate: '2025-03-02',
                price: '800000',
                status: 'Chưa sử dụng'
            },
            {
                id: 'T003',
                eventName: 'Hòa nhạc mùa xuân 2025',
                ticketType: 'Kinh tế',
                customerName: 'Lê Văn C',
                purchaseDate: '2025-03-03',
                price: '500000',
                status: 'Đã hủy'
            }
        ];

        // Function to format price
        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND'
            }).format(price);
        }

        // Function to get status class
        function getStatusClass(status) {
            switch (status) {
                case 'Đã sử dụng':
                    return 'status-completed';
                case 'Chưa sử dụng':
                    return 'status-pending';
                case 'Đã hủy':
                    return 'status-failed';
                default:
                    return '';
            }
        }

        // Function to render tickets table
        function renderTickets(ticketList) {
            const tbody = document.getElementById('ticketTableBody');
            tbody.innerHTML = '';
            
            ticketList.forEach(ticket => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${ticket.id}</td>
                    <td>${ticket.eventName}</td>
                    <td>${ticket.ticketType}</td>
                    <td>${ticket.customerName}</td>
                    <td>${ticket.purchaseDate}</td>
                    <td>${formatPrice(ticket.price)}</td>
                    <td>
                        <span class="status-badge ${getStatusClass(ticket.status)}">
                            ${ticket.status}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button 
                                class="action-btn view-btn" 
                                title="Xem chi tiết"
                                onclick="handleView('${ticket.id}')"
                            >
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Function to handle search
        function handleSearch() {
            const searchQuery = document.getElementById('searchInput').value.toLowerCase();
            const filteredTickets = tickets.filter(ticket => 
                ticket.id.toLowerCase().includes(searchQuery) ||
                ticket.customerName.toLowerCase().includes(searchQuery)
            );
            renderTickets(filteredTickets);
        }

        // Function to apply filters
        function applyFilters() {
            const event = document.querySelector('select[name="event"]').value;
            const ticketType = document.querySelector('select[name="ticketType"]').value;
            const status = document.querySelector('select[name="status"]').value;
            const searchQuery = document.getElementById('searchInput').value.toLowerCase();

            let filteredTickets = [...tickets];

            if (event) {
                filteredTickets = filteredTickets.filter(ticket => 
                    ticket.eventName.toLowerCase().includes(event.toLowerCase())
                );
            }
            if (ticketType) {
                filteredTickets = filteredTickets.filter(ticket => 
                    ticket.ticketType.toLowerCase() === ticketType.toLowerCase()
                );
            }
            if (status) {
                let statusText = '';
                switch (status) {
                    case 'used':
                        statusText = 'Đã sử dụng';
                        break;
                    case 'unused':
                        statusText = 'Chưa sử dụng';
                        break;
                    case 'cancelled':
                        statusText = 'Đã hủy';
                        break;
                }
                filteredTickets = filteredTickets.filter(ticket => 
                    ticket.status === statusText
                );
            }
            if (searchQuery) {
                filteredTickets = filteredTickets.filter(ticket => 
                    ticket.id.toLowerCase().includes(searchQuery) ||
                    ticket.customerName.toLowerCase().includes(searchQuery)
                );
            }

            renderTickets(filteredTickets);
        }

        // Function to reset filters
        function resetFilters() {
            document.querySelector('select[name="event"]').value = '';
            document.querySelector('select[name="ticketType"]').value = '';
            document.querySelector('select[name="status"]').value = '';
            document.getElementById('searchInput').value = '';
            renderTickets(tickets);
        }

        // Event actions
        function handleView(id) {
            window.location.href = `ticket-detail.html?id=${id}`;
        }

        // Pagination functions
        function goToPage(page) {
            // Implement pagination logic here
            console.log('Going to page:', page);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            renderTickets(tickets);
            
            // Add search input event listener
            document.getElementById('searchInput').addEventListener('input', handleSearch);
        });
    </script>
</body>
</html> 